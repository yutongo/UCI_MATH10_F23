

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Predicting Success of MLB Teams &#8212; UC Irvine Math 10, Fall 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Course Project/Student Projects/EricCao';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    UC Irvine, Math 10, Fall 2023
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week0/Week0_Intro.html">Week 0</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week0/Week_0_Friday.html">Week 0 Friday</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week1/Week1_Intro.html">Week 1</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week1/Week_1_Monday.html">Week 1 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week1/Week_1_Wednesday.html">Week 1 Wednesday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week1/Week_1_Friday.html">Week 1 Friday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week2/Week2_Intro.html">Week 2</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week2/Week_2_Monday.html">Week 2 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week2/Week_2_Wednesday.html">Week 2 Wednesday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week2/Week_2_Friday.html">Week 2 Friday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week3/Week3_Intro.html">Week 3</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week3/Week_3_Monday.html">Week 3 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week3/Week_3_Wednesday.html">Week 3 Wednesday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week3/Week_3_Friday.html">Week 3 Friday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week4/Week4_Intro.html">Week 4</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week4/Week_4_Monday.html">Week 4 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week4/Week_4_Wednesday.html">Week 4 Wednesday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week4/Week_4_Friday.html">Week 4 Friday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week5/Week5_Intro.html">Week 5</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week5/Week_5_Wednesday.html">Week 5 Wednesday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week5/Week_5_Friday.html">Week 5 Friday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week6/Week6_Intro.html">Week 6</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week6/Week_6_Monday.html">Week 6 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week6/Week_6_Wednesday.html">Week 6 Wednesday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week7/Week7_Intro.html">Week 7</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week7/Week_7_Monday.html">Week 7 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week7/Week_7_Wednesday.html">Week 7 Wednesday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week7/Week_7_Thursday.html">Week 7 Thursday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week8/Week8_Intro.html">Week 8</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week8/Week_8_Monday.html">Week 8 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week8/Week_8_Wednesday.html">Week 8 Wednesday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Week9/Week9_Intro.html">Week 9</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Week9/Week_9_Monday.html">Week 9 Monday</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Week9/Week_9_Wednesday.html">Week 9 Wednesday</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Project%20Instructions.html">Project Instructions</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Possible%20Extra%20Topics.html">Possible extra topics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Student_Projects.html">Student Projects</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="KhanhLinhBui.html">Gender Inequality</a></li>



</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/yutongo/UCI_MATH10_F23" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Course Project/Student Projects/EricCao.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Predicting Success of MLB Teams</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-the-data">Cleaning the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-model">Linear Regression Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-classifier">Random Forest Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network">Neural Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="predicting-success-of-mlb-teams">
<h1>Predicting Success of MLB Teams<a class="headerlink" href="#predicting-success-of-mlb-teams" title="Permalink to this heading">#</a></h1>
<p>Author: Eric Cao</p>
<p>Course Project, UC Irvine, Math 10, F23</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Among baseball executives and fans, there is much debate about the way a MLB team’s roster should be constructed. Some abide by the slogan “Defense wins championships”, while others place more emphasis on offense. The goal of this project is to apply machine learning methods to a dataset containing teams’ stats to determine which stats, if any, have the largest effect on a team’s success.</p>
</section>
<section id="cleaning-the-data">
<h2>Cleaning the Data<a class="headerlink" href="#cleaning-the-data" title="Permalink to this heading">#</a></h2>
<p>First import all the necessary modules and functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-12-14 08:52:56.790851: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-14 08:52:57.097621: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcudart.so.11.0&#39;; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2023-12-14 08:52:57.097645: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-12-14 08:52:57.187274: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-12-14 08:52:58.839821: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libnvinfer.so.7&#39;; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-12-14 08:52:58.839909: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libnvinfer_plugin.so.7&#39;; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-12-14 08:52:58.839919: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;mlb_teams.csv&#39;</span><span class="p">)</span>
<span class="n">df_raw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>league_id</th>
      <th>division_id</th>
      <th>rank</th>
      <th>games_played</th>
      <th>home_games</th>
      <th>wins</th>
      <th>losses</th>
      <th>division_winner</th>
      <th>wild_card_winner</th>
      <th>...</th>
      <th>hits_allowed</th>
      <th>homeruns_allowed</th>
      <th>walks_allowed</th>
      <th>strikeouts_by_pitchers</th>
      <th>errors</th>
      <th>double_plays</th>
      <th>fielding_percentage</th>
      <th>team_name</th>
      <th>ball_park</th>
      <th>home_attendance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1876</td>
      <td>NL</td>
      <td>NaN</td>
      <td>4</td>
      <td>70</td>
      <td>NaN</td>
      <td>39</td>
      <td>31</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>732</td>
      <td>7</td>
      <td>104</td>
      <td>77</td>
      <td>442</td>
      <td>42</td>
      <td>0.860</td>
      <td>Boston Red Caps</td>
      <td>South End Grounds I</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1876</td>
      <td>NL</td>
      <td>NaN</td>
      <td>1</td>
      <td>66</td>
      <td>NaN</td>
      <td>52</td>
      <td>14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>608</td>
      <td>6</td>
      <td>29</td>
      <td>51</td>
      <td>282</td>
      <td>33</td>
      <td>0.899</td>
      <td>Chicago White Stockings</td>
      <td>23rd Street Grounds</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1876</td>
      <td>NL</td>
      <td>NaN</td>
      <td>8</td>
      <td>65</td>
      <td>NaN</td>
      <td>9</td>
      <td>56</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>850</td>
      <td>9</td>
      <td>34</td>
      <td>60</td>
      <td>469</td>
      <td>45</td>
      <td>0.841</td>
      <td>Cincinnati Reds</td>
      <td>Avenue Grounds</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1876</td>
      <td>NL</td>
      <td>NaN</td>
      <td>2</td>
      <td>69</td>
      <td>NaN</td>
      <td>47</td>
      <td>21</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>570</td>
      <td>2</td>
      <td>27</td>
      <td>114</td>
      <td>337</td>
      <td>27</td>
      <td>0.888</td>
      <td>Hartford Dark Blues</td>
      <td>Hartford Ball Club Grounds</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1876</td>
      <td>NL</td>
      <td>NaN</td>
      <td>5</td>
      <td>69</td>
      <td>NaN</td>
      <td>30</td>
      <td>36</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>605</td>
      <td>3</td>
      <td>38</td>
      <td>125</td>
      <td>397</td>
      <td>44</td>
      <td>0.875</td>
      <td>Louisville Grays</td>
      <td>Louisville Baseball Park</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2779</th>
      <td>2020</td>
      <td>NL</td>
      <td>C</td>
      <td>3</td>
      <td>58</td>
      <td>27.0</td>
      <td>30</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>...</td>
      <td>376</td>
      <td>69</td>
      <td>204</td>
      <td>464</td>
      <td>33</td>
      <td>46</td>
      <td>0.983</td>
      <td>St. Louis Cardinals</td>
      <td>Busch Stadium III</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2780</th>
      <td>2020</td>
      <td>AL</td>
      <td>E</td>
      <td>1</td>
      <td>60</td>
      <td>29.0</td>
      <td>40</td>
      <td>20</td>
      <td>Y</td>
      <td>N</td>
      <td>...</td>
      <td>475</td>
      <td>70</td>
      <td>168</td>
      <td>552</td>
      <td>33</td>
      <td>52</td>
      <td>0.985</td>
      <td>Tampa Bay Rays</td>
      <td>Tropicana Field</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2781</th>
      <td>2020</td>
      <td>AL</td>
      <td>W</td>
      <td>5</td>
      <td>60</td>
      <td>30.0</td>
      <td>22</td>
      <td>38</td>
      <td>N</td>
      <td>N</td>
      <td>...</td>
      <td>479</td>
      <td>81</td>
      <td>236</td>
      <td>489</td>
      <td>40</td>
      <td>40</td>
      <td>0.981</td>
      <td>Texas Rangers</td>
      <td>Globe Life Field</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2782</th>
      <td>2020</td>
      <td>AL</td>
      <td>E</td>
      <td>3</td>
      <td>60</td>
      <td>26.0</td>
      <td>32</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>...</td>
      <td>517</td>
      <td>81</td>
      <td>250</td>
      <td>519</td>
      <td>38</td>
      <td>47</td>
      <td>0.982</td>
      <td>Toronto Blue Jays</td>
      <td>Sahlen Field</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>2020</td>
      <td>NL</td>
      <td>E</td>
      <td>4</td>
      <td>60</td>
      <td>33.0</td>
      <td>26</td>
      <td>34</td>
      <td>N</td>
      <td>N</td>
      <td>...</td>
      <td>548</td>
      <td>94</td>
      <td>216</td>
      <td>508</td>
      <td>39</td>
      <td>48</td>
      <td>0.981</td>
      <td>Washington Nationals</td>
      <td>Nationals Park</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>2784 rows × 41 columns</p>
</div></div></div>
</div>
<p>My dataset contains data on teams spanning back to 1876. I will remove the unimportant columns. Some stats were not yet created and collected back then, so I will also remove the rows that do not contain this data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_count</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;league_id&#39;</span><span class="p">,</span> <span class="s1">&#39;division_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rank&#39;</span><span class="p">,</span> <span class="s1">&#39;home_games&#39;</span><span class="p">,</span>  <span class="s1">&#39;team_name&#39;</span><span class="p">,</span> <span class="s1">&#39;ball_park&#39;</span><span class="p">,</span> <span class="s1">&#39;home_attendance&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_count</span> <span class="o">=</span> <span class="n">df_count</span><span class="p">[</span><span class="o">~</span><span class="n">df_count</span><span class="p">[</span><span class="s1">&#39;caught_stealing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">df_count</span><span class="p">[</span><span class="s1">&#39;sacrifice_flies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">df_count</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year                        0
games_played                0
wins                        0
losses                      0
division_winner            28
wild_card_winner          640
league_winner              28
world_series_winner        28
runs_scored                 0
at_bats                     0
hits                        0
doubles                     0
triples                     0
homeruns                    0
walks                       0
strikeouts_by_batters       0
stolen_bases                0
caught_stealing             0
batters_hit_by_pitch        0
sacrifice_flies             0
opponents_runs_scored       0
earned_runs_allowed         0
earned_run_average          0
complete_games              0
shutouts                    0
saves                       0
outs_pitches                0
hits_allowed                0
homeruns_allowed            0
walks_allowed               0
strikeouts_by_pitchers      0
errors                      0
double_plays                0
fielding_percentage         0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Note: There are missing values in the columns <code class="docutils literal notranslate"><span class="pre">division_winner</span></code>, <code class="docutils literal notranslate"><span class="pre">wild_card_winner</span></code>, <code class="docutils literal notranslate"><span class="pre">league_winner</span></code>, and <code class="docutils literal notranslate"><span class="pre">world_series_winner</span></code>. I have not removed the rows corresponding to these missing values because I will not be using these columns for the first two models.</p>
</section>
<section id="linear-regression-model">
<h2>Linear Regression Model<a class="headerlink" href="#linear-regression-model" title="Permalink to this heading">#</a></h2>
<p>One way to determine a team’s success is by its winning percentage. Since this dataset only contains number of wins, I will add a <code class="docutils literal notranslate"><span class="pre">win_percentage</span></code> column to it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_count</span><span class="p">[</span><span class="s1">&#39;win_percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_count</span><span class="p">[</span><span class="s1">&#39;wins&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_count</span><span class="p">[</span><span class="s1">&#39;games_played&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Many of the stats use different scales, so I will normalize all the stats on a scale of 0 to 1 using <code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code>. This will allow the data to be correctly analyzed via machine learning methods. I got this idea from ChatGPT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_rate</span> <span class="o">=</span> <span class="n">df_count</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_rate</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;runs_scored&#39;</span><span class="p">:</span> <span class="s1">&#39;fielding_percentage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_rate</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_rate</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
<span class="n">df_rate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>games_played</th>
      <th>wins</th>
      <th>losses</th>
      <th>division_winner</th>
      <th>wild_card_winner</th>
      <th>league_winner</th>
      <th>world_series_winner</th>
      <th>runs_scored</th>
      <th>at_bats</th>
      <th>...</th>
      <th>saves</th>
      <th>outs_pitches</th>
      <th>hits_allowed</th>
      <th>homeruns_allowed</th>
      <th>walks_allowed</th>
      <th>strikeouts_by_pitchers</th>
      <th>errors</th>
      <th>double_plays</th>
      <th>fielding_percentage</th>
      <th>win_percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1370</th>
      <td>1970</td>
      <td>162</td>
      <td>76</td>
      <td>86</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.654430</td>
      <td>0.941673</td>
      <td>...</td>
      <td>0.290323</td>
      <td>0.937052</td>
      <td>0.791605</td>
      <td>0.547170</td>
      <td>0.521127</td>
      <td>0.440339</td>
      <td>0.675978</td>
      <td>0.491329</td>
      <td>0.391304</td>
      <td>0.469136</td>
    </tr>
    <tr>
      <th>1371</th>
      <td>1970</td>
      <td>162</td>
      <td>108</td>
      <td>54</td>
      <td>Y</td>
      <td>NaN</td>
      <td>Y</td>
      <td>Y</td>
      <td>0.725316</td>
      <td>0.941425</td>
      <td>...</td>
      <td>0.403226</td>
      <td>0.984018</td>
      <td>0.692931</td>
      <td>0.373585</td>
      <td>0.507042</td>
      <td>0.425712</td>
      <td>0.541899</td>
      <td>0.664740</td>
      <td>0.565217</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1372</th>
      <td>1970</td>
      <td>162</td>
      <td>87</td>
      <td>75</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.717722</td>
      <td>0.938943</td>
      <td>...</td>
      <td>0.612903</td>
      <td>0.952381</td>
      <td>0.747423</td>
      <td>0.437736</td>
      <td>0.702660</td>
      <td>0.473441</td>
      <td>0.759777</td>
      <td>0.566474</td>
      <td>0.260870</td>
      <td>0.537037</td>
    </tr>
    <tr>
      <th>1373</th>
      <td>1970</td>
      <td>162</td>
      <td>86</td>
      <td>76</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.521519</td>
      <td>0.938198</td>
      <td>...</td>
      <td>0.693548</td>
      <td>0.968037</td>
      <td>0.665685</td>
      <td>0.430189</td>
      <td>0.647887</td>
      <td>0.411085</td>
      <td>0.597765</td>
      <td>0.786127</td>
      <td>0.521739</td>
      <td>0.530864</td>
    </tr>
    <tr>
      <th>1374</th>
      <td>1970</td>
      <td>162</td>
      <td>56</td>
      <td>106</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.524051</td>
      <td>0.933730</td>
      <td>...</td>
      <td>0.387097</td>
      <td>0.936725</td>
      <td>0.867452</td>
      <td>0.467925</td>
      <td>0.643192</td>
      <td>0.287914</td>
      <td>0.810056</td>
      <td>0.890173</td>
      <td>0.304348</td>
      <td>0.345679</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2779</th>
      <td>2020</td>
      <td>58</td>
      <td>30</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
      <td>0.026582</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.112903</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.109434</td>
      <td>0.092332</td>
      <td>0.058507</td>
      <td>0.072626</td>
      <td>0.075145</td>
      <td>0.652174</td>
      <td>0.517241</td>
    </tr>
    <tr>
      <th>2780</th>
      <td>2020</td>
      <td>60</td>
      <td>40</td>
      <td>20</td>
      <td>Y</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>0.088608</td>
      <td>0.055349</td>
      <td>...</td>
      <td>0.274194</td>
      <td>0.053490</td>
      <td>0.072901</td>
      <td>0.113208</td>
      <td>0.035994</td>
      <td>0.126251</td>
      <td>0.072626</td>
      <td>0.109827</td>
      <td>0.739130</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2781</th>
      <td>2020</td>
      <td>60</td>
      <td>22</td>
      <td>38</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.006329</td>
      <td>0.045669</td>
      <td>...</td>
      <td>0.064516</td>
      <td>0.042727</td>
      <td>0.075847</td>
      <td>0.154717</td>
      <td>0.142410</td>
      <td>0.077752</td>
      <td>0.111732</td>
      <td>0.040462</td>
      <td>0.565217</td>
      <td>0.366667</td>
    </tr>
    <tr>
      <th>2782</th>
      <td>2020</td>
      <td>60</td>
      <td>32</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
      <td>0.105063</td>
      <td>0.067262</td>
      <td>...</td>
      <td>0.177419</td>
      <td>0.050554</td>
      <td>0.103829</td>
      <td>0.154717</td>
      <td>0.164319</td>
      <td>0.100847</td>
      <td>0.100559</td>
      <td>0.080925</td>
      <td>0.608696</td>
      <td>0.533333</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>2020</td>
      <td>60</td>
      <td>26</td>
      <td>34</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.093671</td>
      <td>0.053611</td>
      <td>...</td>
      <td>0.096774</td>
      <td>0.030007</td>
      <td>0.126657</td>
      <td>0.203774</td>
      <td>0.111111</td>
      <td>0.092379</td>
      <td>0.106145</td>
      <td>0.086705</td>
      <td>0.565217</td>
      <td>0.433333</td>
    </tr>
  </tbody>
</table>
<p>1414 rows × 35 columns</p>
</div></div></div>
</div>
<p>Because the target variable <code class="docutils literal notranslate"><span class="pre">win_percentage</span></code> is quantitative, determining the relationship between the stats and <code class="docutils literal notranslate"><span class="pre">win_percentage</span></code> is a regression problem. Therefore, I need to fit a linear regression model between each stat and <code class="docutils literal notranslate"><span class="pre">win_percentage</span></code>, returning each model’s coefficient, mean squared error, and mean absolute error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">coefs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">mse</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">mae</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_rate</span><span class="p">[[</span><span class="n">col</span><span class="p">]],</span> <span class="n">df_rate</span><span class="p">[</span><span class="s1">&#39;win_percentage&#39;</span><span class="p">])</span>
    <span class="n">coefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">mse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df_rate</span><span class="p">[</span><span class="s1">&#39;win_percentage&#39;</span><span class="p">],</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_rate</span><span class="p">[[</span><span class="n">col</span><span class="p">]])))</span>
    <span class="n">mae</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">df_rate</span><span class="p">[</span><span class="s1">&#39;win_percentage&#39;</span><span class="p">],</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_rate</span><span class="p">[[</span><span class="n">col</span><span class="p">]])))</span>

<span class="n">df_rate_reg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Stat&#39;</span><span class="p">:</span> <span class="n">cols</span><span class="p">,</span> <span class="s1">&#39;Coefficient&#39;</span><span class="p">:</span> <span class="n">coefs</span><span class="p">,</span> <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span> <span class="s1">&#39;Mean Absolute Error&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">})</span>
<span class="n">df_rate_reg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stat</th>
      <th>Coefficient</th>
      <th>Mean Squared Error</th>
      <th>Mean Absolute Error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>runs_scored</td>
      <td>0.188315</td>
      <td>0.004267</td>
      <td>0.052642</td>
    </tr>
    <tr>
      <th>1</th>
      <td>at_bats</td>
      <td>0.011933</td>
      <td>0.005020</td>
      <td>0.058330</td>
    </tr>
    <tr>
      <th>2</th>
      <td>hits</td>
      <td>0.087089</td>
      <td>0.004877</td>
      <td>0.057019</td>
    </tr>
    <tr>
      <th>3</th>
      <td>doubles</td>
      <td>0.076541</td>
      <td>0.004881</td>
      <td>0.057288</td>
    </tr>
    <tr>
      <th>4</th>
      <td>triples</td>
      <td>0.017559</td>
      <td>0.005017</td>
      <td>0.058268</td>
    </tr>
    <tr>
      <th>5</th>
      <td>homeruns</td>
      <td>0.128334</td>
      <td>0.004606</td>
      <td>0.055547</td>
    </tr>
    <tr>
      <th>6</th>
      <td>walks</td>
      <td>0.156944</td>
      <td>0.004541</td>
      <td>0.054853</td>
    </tr>
    <tr>
      <th>7</th>
      <td>strikeouts_by_batters</td>
      <td>-0.024567</td>
      <td>0.005004</td>
      <td>0.058242</td>
    </tr>
    <tr>
      <th>8</th>
      <td>stolen_bases</td>
      <td>0.068245</td>
      <td>0.004951</td>
      <td>0.057895</td>
    </tr>
    <tr>
      <th>9</th>
      <td>caught_stealing</td>
      <td>-0.024082</td>
      <td>0.005011</td>
      <td>0.058374</td>
    </tr>
    <tr>
      <th>10</th>
      <td>batters_hit_by_pitch</td>
      <td>0.038366</td>
      <td>0.004974</td>
      <td>0.058146</td>
    </tr>
    <tr>
      <th>11</th>
      <td>sacrifice_flies</td>
      <td>0.122088</td>
      <td>0.004706</td>
      <td>0.055930</td>
    </tr>
    <tr>
      <th>12</th>
      <td>opponents_runs_scored</td>
      <td>-0.229026</td>
      <td>0.004115</td>
      <td>0.051231</td>
    </tr>
    <tr>
      <th>13</th>
      <td>earned_runs_allowed</td>
      <td>-0.214156</td>
      <td>0.004214</td>
      <td>0.052116</td>
    </tr>
    <tr>
      <th>14</th>
      <td>earned_run_average</td>
      <td>-0.253572</td>
      <td>0.003590</td>
      <td>0.047939</td>
    </tr>
    <tr>
      <th>15</th>
      <td>complete_games</td>
      <td>0.036581</td>
      <td>0.004986</td>
      <td>0.058083</td>
    </tr>
    <tr>
      <th>16</th>
      <td>shutouts</td>
      <td>0.163535</td>
      <td>0.004180</td>
      <td>0.052013</td>
    </tr>
    <tr>
      <th>17</th>
      <td>saves</td>
      <td>0.206479</td>
      <td>0.003990</td>
      <td>0.050757</td>
    </tr>
    <tr>
      <th>18</th>
      <td>outs_pitches</td>
      <td>0.016956</td>
      <td>0.005016</td>
      <td>0.058276</td>
    </tr>
    <tr>
      <th>19</th>
      <td>hits_allowed</td>
      <td>-0.117936</td>
      <td>0.004771</td>
      <td>0.056385</td>
    </tr>
    <tr>
      <th>20</th>
      <td>homeruns_allowed</td>
      <td>-0.099719</td>
      <td>0.004814</td>
      <td>0.056881</td>
    </tr>
    <tr>
      <th>21</th>
      <td>walks_allowed</td>
      <td>-0.177109</td>
      <td>0.004461</td>
      <td>0.054053</td>
    </tr>
    <tr>
      <th>22</th>
      <td>strikeouts_by_pitchers</td>
      <td>0.064297</td>
      <td>0.004907</td>
      <td>0.057443</td>
    </tr>
    <tr>
      <th>23</th>
      <td>errors</td>
      <td>-0.105935</td>
      <td>0.004768</td>
      <td>0.056594</td>
    </tr>
    <tr>
      <th>24</th>
      <td>double_plays</td>
      <td>-0.048609</td>
      <td>0.004975</td>
      <td>0.058041</td>
    </tr>
    <tr>
      <th>25</th>
      <td>fielding_percentage</td>
      <td>0.126001</td>
      <td>0.004620</td>
      <td>0.055467</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Each stat’s corresponding coefficient, mean squared error, and mean absolute error are visualized below in three bar charts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_rate_reg</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Stat&#39;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Coefficient&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-85e59b35e2764acf8bab3679377922fa"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-85e59b35e2764acf8bab3679377922fa") {
      outputDiv = document.getElementById("altair-viz-85e59b35e2764acf8bab3679377922fa");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-4699ee03d75cbfa803aaed570d94955c"}, "mark": "bar", "encoding": {"x": {"field": "Stat", "type": "nominal"}, "y": {"field": "Coefficient", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-4699ee03d75cbfa803aaed570d94955c": [{"Stat": "runs_scored", "Coefficient": 0.18831465814767837, "Mean Squared Error": 0.004266515515217094, "Mean Absolute Error": 0.05264240713472383}, {"Stat": "at_bats", "Coefficient": 0.011933267491838793, "Mean Squared Error": 0.005019918906914223, "Mean Absolute Error": 0.058330242808397714}, {"Stat": "hits", "Coefficient": 0.08708879585039338, "Mean Squared Error": 0.004876715018059652, "Mean Absolute Error": 0.05701877287162924}, {"Stat": "doubles", "Coefficient": 0.07654114621716178, "Mean Squared Error": 0.004880644195008177, "Mean Absolute Error": 0.05728794363951976}, {"Stat": "triples", "Coefficient": 0.017559026006174015, "Mean Squared Error": 0.005017089296757197, "Mean Absolute Error": 0.058267562521668675}, {"Stat": "homeruns", "Coefficient": 0.12833354855059362, "Mean Squared Error": 0.004606249066973834, "Mean Absolute Error": 0.05554685804937392}, {"Stat": "walks", "Coefficient": 0.15694413276024058, "Mean Squared Error": 0.004541416343688197, "Mean Absolute Error": 0.0548526386314366}, {"Stat": "strikeouts_by_batters", "Coefficient": -0.02456663431627061, "Mean Squared Error": 0.0050040323346889634, "Mean Absolute Error": 0.05824248025194502}, {"Stat": "stolen_bases", "Coefficient": 0.06824537728609718, "Mean Squared Error": 0.004951446688690521, "Mean Absolute Error": 0.057895296743758276}, {"Stat": "caught_stealing", "Coefficient": -0.02408160346196963, "Mean Squared Error": 0.005010587425961018, "Mean Absolute Error": 0.05837438275504105}, {"Stat": "batters_hit_by_pitch", "Coefficient": 0.03836552096760287, "Mean Squared Error": 0.004973872390893573, "Mean Absolute Error": 0.05814624151066167}, {"Stat": "sacrifice_flies", "Coefficient": 0.12208772709586446, "Mean Squared Error": 0.0047063417273905395, "Mean Absolute Error": 0.055929639220551455}, {"Stat": "opponents_runs_scored", "Coefficient": -0.22902636690550687, "Mean Squared Error": 0.0041149693944016645, "Mean Absolute Error": 0.05123060737018091}, {"Stat": "earned_runs_allowed", "Coefficient": -0.2141556434694785, "Mean Squared Error": 0.0042144115959049456, "Mean Absolute Error": 0.052116288461668964}, {"Stat": "earned_run_average", "Coefficient": -0.2535718640882465, "Mean Squared Error": 0.003589898900884073, "Mean Absolute Error": 0.04793870265449636}, {"Stat": "complete_games", "Coefficient": 0.03658124880842796, "Mean Squared Error": 0.004986129913870648, "Mean Absolute Error": 0.05808257831382118}, {"Stat": "shutouts", "Coefficient": 0.16353459095212416, "Mean Squared Error": 0.004179661830342178, "Mean Absolute Error": 0.05201349014821077}, {"Stat": "saves", "Coefficient": 0.20647923771093976, "Mean Squared Error": 0.00399019892933553, "Mean Absolute Error": 0.05075724242940754}, {"Stat": "outs_pitches", "Coefficient": 0.016956189325817418, "Mean Squared Error": 0.005016217709180244, "Mean Absolute Error": 0.058276034946909916}, {"Stat": "hits_allowed", "Coefficient": -0.117935699748463, "Mean Squared Error": 0.004771451163567211, "Mean Absolute Error": 0.05638493227476301}, {"Stat": "homeruns_allowed", "Coefficient": -0.09971937130432491, "Mean Squared Error": 0.0048143555521540015, "Mean Absolute Error": 0.056880882586752175}, {"Stat": "walks_allowed", "Coefficient": -0.17710885818289282, "Mean Squared Error": 0.004461032599246258, "Mean Absolute Error": 0.054052572447424015}, {"Stat": "strikeouts_by_pitchers", "Coefficient": 0.06429719931775642, "Mean Squared Error": 0.004906897821013346, "Mean Absolute Error": 0.057443446524362736}, {"Stat": "errors", "Coefficient": -0.10593462464819306, "Mean Squared Error": 0.004768345974218516, "Mean Absolute Error": 0.056593939573452726}, {"Stat": "double_plays", "Coefficient": -0.04860936180581573, "Mean Squared Error": 0.004974802540030119, "Mean Absolute Error": 0.05804083243273729}, {"Stat": "fielding_percentage", "Coefficient": 0.12600108206478403, "Mean Squared Error": 0.004619919992552827, "Mean Absolute Error": 0.0554672158268625}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_rate_reg</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Stat&#39;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Mean Squared Error&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-fd2271d3981b4a47b503b027867ff82b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-fd2271d3981b4a47b503b027867ff82b") {
      outputDiv = document.getElementById("altair-viz-fd2271d3981b4a47b503b027867ff82b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-4699ee03d75cbfa803aaed570d94955c"}, "mark": {"type": "bar", "color": "lightgreen"}, "encoding": {"x": {"field": "Stat", "type": "nominal"}, "y": {"field": "Mean Squared Error", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-4699ee03d75cbfa803aaed570d94955c": [{"Stat": "runs_scored", "Coefficient": 0.18831465814767837, "Mean Squared Error": 0.004266515515217094, "Mean Absolute Error": 0.05264240713472383}, {"Stat": "at_bats", "Coefficient": 0.011933267491838793, "Mean Squared Error": 0.005019918906914223, "Mean Absolute Error": 0.058330242808397714}, {"Stat": "hits", "Coefficient": 0.08708879585039338, "Mean Squared Error": 0.004876715018059652, "Mean Absolute Error": 0.05701877287162924}, {"Stat": "doubles", "Coefficient": 0.07654114621716178, "Mean Squared Error": 0.004880644195008177, "Mean Absolute Error": 0.05728794363951976}, {"Stat": "triples", "Coefficient": 0.017559026006174015, "Mean Squared Error": 0.005017089296757197, "Mean Absolute Error": 0.058267562521668675}, {"Stat": "homeruns", "Coefficient": 0.12833354855059362, "Mean Squared Error": 0.004606249066973834, "Mean Absolute Error": 0.05554685804937392}, {"Stat": "walks", "Coefficient": 0.15694413276024058, "Mean Squared Error": 0.004541416343688197, "Mean Absolute Error": 0.0548526386314366}, {"Stat": "strikeouts_by_batters", "Coefficient": -0.02456663431627061, "Mean Squared Error": 0.0050040323346889634, "Mean Absolute Error": 0.05824248025194502}, {"Stat": "stolen_bases", "Coefficient": 0.06824537728609718, "Mean Squared Error": 0.004951446688690521, "Mean Absolute Error": 0.057895296743758276}, {"Stat": "caught_stealing", "Coefficient": -0.02408160346196963, "Mean Squared Error": 0.005010587425961018, "Mean Absolute Error": 0.05837438275504105}, {"Stat": "batters_hit_by_pitch", "Coefficient": 0.03836552096760287, "Mean Squared Error": 0.004973872390893573, "Mean Absolute Error": 0.05814624151066167}, {"Stat": "sacrifice_flies", "Coefficient": 0.12208772709586446, "Mean Squared Error": 0.0047063417273905395, "Mean Absolute Error": 0.055929639220551455}, {"Stat": "opponents_runs_scored", "Coefficient": -0.22902636690550687, "Mean Squared Error": 0.0041149693944016645, "Mean Absolute Error": 0.05123060737018091}, {"Stat": "earned_runs_allowed", "Coefficient": -0.2141556434694785, "Mean Squared Error": 0.0042144115959049456, "Mean Absolute Error": 0.052116288461668964}, {"Stat": "earned_run_average", "Coefficient": -0.2535718640882465, "Mean Squared Error": 0.003589898900884073, "Mean Absolute Error": 0.04793870265449636}, {"Stat": "complete_games", "Coefficient": 0.03658124880842796, "Mean Squared Error": 0.004986129913870648, "Mean Absolute Error": 0.05808257831382118}, {"Stat": "shutouts", "Coefficient": 0.16353459095212416, "Mean Squared Error": 0.004179661830342178, "Mean Absolute Error": 0.05201349014821077}, {"Stat": "saves", "Coefficient": 0.20647923771093976, "Mean Squared Error": 0.00399019892933553, "Mean Absolute Error": 0.05075724242940754}, {"Stat": "outs_pitches", "Coefficient": 0.016956189325817418, "Mean Squared Error": 0.005016217709180244, "Mean Absolute Error": 0.058276034946909916}, {"Stat": "hits_allowed", "Coefficient": -0.117935699748463, "Mean Squared Error": 0.004771451163567211, "Mean Absolute Error": 0.05638493227476301}, {"Stat": "homeruns_allowed", "Coefficient": -0.09971937130432491, "Mean Squared Error": 0.0048143555521540015, "Mean Absolute Error": 0.056880882586752175}, {"Stat": "walks_allowed", "Coefficient": -0.17710885818289282, "Mean Squared Error": 0.004461032599246258, "Mean Absolute Error": 0.054052572447424015}, {"Stat": "strikeouts_by_pitchers", "Coefficient": 0.06429719931775642, "Mean Squared Error": 0.004906897821013346, "Mean Absolute Error": 0.057443446524362736}, {"Stat": "errors", "Coefficient": -0.10593462464819306, "Mean Squared Error": 0.004768345974218516, "Mean Absolute Error": 0.056593939573452726}, {"Stat": "double_plays", "Coefficient": -0.04860936180581573, "Mean Squared Error": 0.004974802540030119, "Mean Absolute Error": 0.05804083243273729}, {"Stat": "fielding_percentage", "Coefficient": 0.12600108206478403, "Mean Squared Error": 0.004619919992552827, "Mean Absolute Error": 0.0554672158268625}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_rate_reg</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkgreen&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Stat&#39;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Mean Absolute Error&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-857fe9ce2ecd4b6b992a5b2dbaeb3ad0"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-857fe9ce2ecd4b6b992a5b2dbaeb3ad0") {
      outputDiv = document.getElementById("altair-viz-857fe9ce2ecd4b6b992a5b2dbaeb3ad0");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-4699ee03d75cbfa803aaed570d94955c"}, "mark": {"type": "bar", "color": "darkgreen"}, "encoding": {"x": {"field": "Stat", "type": "nominal"}, "y": {"field": "Mean Absolute Error", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-4699ee03d75cbfa803aaed570d94955c": [{"Stat": "runs_scored", "Coefficient": 0.18831465814767837, "Mean Squared Error": 0.004266515515217094, "Mean Absolute Error": 0.05264240713472383}, {"Stat": "at_bats", "Coefficient": 0.011933267491838793, "Mean Squared Error": 0.005019918906914223, "Mean Absolute Error": 0.058330242808397714}, {"Stat": "hits", "Coefficient": 0.08708879585039338, "Mean Squared Error": 0.004876715018059652, "Mean Absolute Error": 0.05701877287162924}, {"Stat": "doubles", "Coefficient": 0.07654114621716178, "Mean Squared Error": 0.004880644195008177, "Mean Absolute Error": 0.05728794363951976}, {"Stat": "triples", "Coefficient": 0.017559026006174015, "Mean Squared Error": 0.005017089296757197, "Mean Absolute Error": 0.058267562521668675}, {"Stat": "homeruns", "Coefficient": 0.12833354855059362, "Mean Squared Error": 0.004606249066973834, "Mean Absolute Error": 0.05554685804937392}, {"Stat": "walks", "Coefficient": 0.15694413276024058, "Mean Squared Error": 0.004541416343688197, "Mean Absolute Error": 0.0548526386314366}, {"Stat": "strikeouts_by_batters", "Coefficient": -0.02456663431627061, "Mean Squared Error": 0.0050040323346889634, "Mean Absolute Error": 0.05824248025194502}, {"Stat": "stolen_bases", "Coefficient": 0.06824537728609718, "Mean Squared Error": 0.004951446688690521, "Mean Absolute Error": 0.057895296743758276}, {"Stat": "caught_stealing", "Coefficient": -0.02408160346196963, "Mean Squared Error": 0.005010587425961018, "Mean Absolute Error": 0.05837438275504105}, {"Stat": "batters_hit_by_pitch", "Coefficient": 0.03836552096760287, "Mean Squared Error": 0.004973872390893573, "Mean Absolute Error": 0.05814624151066167}, {"Stat": "sacrifice_flies", "Coefficient": 0.12208772709586446, "Mean Squared Error": 0.0047063417273905395, "Mean Absolute Error": 0.055929639220551455}, {"Stat": "opponents_runs_scored", "Coefficient": -0.22902636690550687, "Mean Squared Error": 0.0041149693944016645, "Mean Absolute Error": 0.05123060737018091}, {"Stat": "earned_runs_allowed", "Coefficient": -0.2141556434694785, "Mean Squared Error": 0.0042144115959049456, "Mean Absolute Error": 0.052116288461668964}, {"Stat": "earned_run_average", "Coefficient": -0.2535718640882465, "Mean Squared Error": 0.003589898900884073, "Mean Absolute Error": 0.04793870265449636}, {"Stat": "complete_games", "Coefficient": 0.03658124880842796, "Mean Squared Error": 0.004986129913870648, "Mean Absolute Error": 0.05808257831382118}, {"Stat": "shutouts", "Coefficient": 0.16353459095212416, "Mean Squared Error": 0.004179661830342178, "Mean Absolute Error": 0.05201349014821077}, {"Stat": "saves", "Coefficient": 0.20647923771093976, "Mean Squared Error": 0.00399019892933553, "Mean Absolute Error": 0.05075724242940754}, {"Stat": "outs_pitches", "Coefficient": 0.016956189325817418, "Mean Squared Error": 0.005016217709180244, "Mean Absolute Error": 0.058276034946909916}, {"Stat": "hits_allowed", "Coefficient": -0.117935699748463, "Mean Squared Error": 0.004771451163567211, "Mean Absolute Error": 0.05638493227476301}, {"Stat": "homeruns_allowed", "Coefficient": -0.09971937130432491, "Mean Squared Error": 0.0048143555521540015, "Mean Absolute Error": 0.056880882586752175}, {"Stat": "walks_allowed", "Coefficient": -0.17710885818289282, "Mean Squared Error": 0.004461032599246258, "Mean Absolute Error": 0.054052572447424015}, {"Stat": "strikeouts_by_pitchers", "Coefficient": 0.06429719931775642, "Mean Squared Error": 0.004906897821013346, "Mean Absolute Error": 0.057443446524362736}, {"Stat": "errors", "Coefficient": -0.10593462464819306, "Mean Squared Error": 0.004768345974218516, "Mean Absolute Error": 0.056593939573452726}, {"Stat": "double_plays", "Coefficient": -0.04860936180581573, "Mean Squared Error": 0.004974802540030119, "Mean Absolute Error": 0.05804083243273729}, {"Stat": "fielding_percentage", "Coefficient": 0.12600108206478403, "Mean Squared Error": 0.004619919992552827, "Mean Absolute Error": 0.0554672158268625}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">earned_run_average</span></code>, <code class="docutils literal notranslate"><span class="pre">earned_runs_allowed</span></code>, and <code class="docutils literal notranslate"><span class="pre">opponents_run_scored</span></code> have the largest absolute value of all coefficients, with an average coefficient of <span class="math notranslate nohighlight">\(-0.22\)</span>. The negative value of the coefficient means that higher values of each of the three stats correlates to a lower <code class="docutils literal notranslate"><span class="pre">win_percentage</span></code>, so successful teams have lower earned runs allowed. Furthermore, these three stats have the lowest mean squared error and lowest mean absolute error of all stats, meaning that these stats are the best predictors of <code class="docutils literal notranslate"><span class="pre">win_percentage</span></code>.</p>
</section>
<section id="random-forest-classifier">
<h2>Random Forest Classifier<a class="headerlink" href="#random-forest-classifier" title="Permalink to this heading">#</a></h2>
<p>A binary way to determine a team’s success is to determine if it is a winning team, which means that its win percentage is over 50%. This will be represented by the <code class="docutils literal notranslate"><span class="pre">is_win</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_rate</span><span class="p">[</span><span class="s1">&#39;is_win&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_rate</span><span class="p">[</span><span class="s1">&#39;win_percentage&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">df_rate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>games_played</th>
      <th>wins</th>
      <th>losses</th>
      <th>division_winner</th>
      <th>wild_card_winner</th>
      <th>league_winner</th>
      <th>world_series_winner</th>
      <th>runs_scored</th>
      <th>at_bats</th>
      <th>...</th>
      <th>outs_pitches</th>
      <th>hits_allowed</th>
      <th>homeruns_allowed</th>
      <th>walks_allowed</th>
      <th>strikeouts_by_pitchers</th>
      <th>errors</th>
      <th>double_plays</th>
      <th>fielding_percentage</th>
      <th>win_percentage</th>
      <th>is_win</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1370</th>
      <td>1970</td>
      <td>162</td>
      <td>76</td>
      <td>86</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.654430</td>
      <td>0.941673</td>
      <td>...</td>
      <td>0.937052</td>
      <td>0.791605</td>
      <td>0.547170</td>
      <td>0.521127</td>
      <td>0.440339</td>
      <td>0.675978</td>
      <td>0.491329</td>
      <td>0.391304</td>
      <td>0.469136</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1371</th>
      <td>1970</td>
      <td>162</td>
      <td>108</td>
      <td>54</td>
      <td>Y</td>
      <td>NaN</td>
      <td>Y</td>
      <td>Y</td>
      <td>0.725316</td>
      <td>0.941425</td>
      <td>...</td>
      <td>0.984018</td>
      <td>0.692931</td>
      <td>0.373585</td>
      <td>0.507042</td>
      <td>0.425712</td>
      <td>0.541899</td>
      <td>0.664740</td>
      <td>0.565217</td>
      <td>0.666667</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1372</th>
      <td>1970</td>
      <td>162</td>
      <td>87</td>
      <td>75</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.717722</td>
      <td>0.938943</td>
      <td>...</td>
      <td>0.952381</td>
      <td>0.747423</td>
      <td>0.437736</td>
      <td>0.702660</td>
      <td>0.473441</td>
      <td>0.759777</td>
      <td>0.566474</td>
      <td>0.260870</td>
      <td>0.537037</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1373</th>
      <td>1970</td>
      <td>162</td>
      <td>86</td>
      <td>76</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.521519</td>
      <td>0.938198</td>
      <td>...</td>
      <td>0.968037</td>
      <td>0.665685</td>
      <td>0.430189</td>
      <td>0.647887</td>
      <td>0.411085</td>
      <td>0.597765</td>
      <td>0.786127</td>
      <td>0.521739</td>
      <td>0.530864</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1374</th>
      <td>1970</td>
      <td>162</td>
      <td>56</td>
      <td>106</td>
      <td>N</td>
      <td>NaN</td>
      <td>N</td>
      <td>N</td>
      <td>0.524051</td>
      <td>0.933730</td>
      <td>...</td>
      <td>0.936725</td>
      <td>0.867452</td>
      <td>0.467925</td>
      <td>0.643192</td>
      <td>0.287914</td>
      <td>0.810056</td>
      <td>0.890173</td>
      <td>0.304348</td>
      <td>0.345679</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2779</th>
      <td>2020</td>
      <td>58</td>
      <td>30</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
      <td>0.026582</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.109434</td>
      <td>0.092332</td>
      <td>0.058507</td>
      <td>0.072626</td>
      <td>0.075145</td>
      <td>0.652174</td>
      <td>0.517241</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2780</th>
      <td>2020</td>
      <td>60</td>
      <td>40</td>
      <td>20</td>
      <td>Y</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>0.088608</td>
      <td>0.055349</td>
      <td>...</td>
      <td>0.053490</td>
      <td>0.072901</td>
      <td>0.113208</td>
      <td>0.035994</td>
      <td>0.126251</td>
      <td>0.072626</td>
      <td>0.109827</td>
      <td>0.739130</td>
      <td>0.666667</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2781</th>
      <td>2020</td>
      <td>60</td>
      <td>22</td>
      <td>38</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.006329</td>
      <td>0.045669</td>
      <td>...</td>
      <td>0.042727</td>
      <td>0.075847</td>
      <td>0.154717</td>
      <td>0.142410</td>
      <td>0.077752</td>
      <td>0.111732</td>
      <td>0.040462</td>
      <td>0.565217</td>
      <td>0.366667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2782</th>
      <td>2020</td>
      <td>60</td>
      <td>32</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
      <td>0.105063</td>
      <td>0.067262</td>
      <td>...</td>
      <td>0.050554</td>
      <td>0.103829</td>
      <td>0.154717</td>
      <td>0.164319</td>
      <td>0.100847</td>
      <td>0.100559</td>
      <td>0.080925</td>
      <td>0.608696</td>
      <td>0.533333</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>2020</td>
      <td>60</td>
      <td>26</td>
      <td>34</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.093671</td>
      <td>0.053611</td>
      <td>...</td>
      <td>0.030007</td>
      <td>0.126657</td>
      <td>0.203774</td>
      <td>0.111111</td>
      <td>0.092379</td>
      <td>0.106145</td>
      <td>0.086705</td>
      <td>0.565217</td>
      <td>0.433333</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>1414 rows × 36 columns</p>
</div></div></div>
</div>
<p>Because the target variable <code class="docutils literal notranslate"><span class="pre">is_win</span></code> is categorical, the model will use each row’s stats to determine its class in <code class="docutils literal notranslate"><span class="pre">is_win</span></code>, which is a classification problem. Therefore, I will use a random forest to model the relationship between stats and <code class="docutils literal notranslate"><span class="pre">is_win</span></code>. One of the main advantages of a random forest is its robustness, which counters overfitting. I also separated the data into training and testing data, which allow us to see if the random forest has overfit our data by testing the model on the testing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df_rate</span><span class="p">[</span><span class="n">cols</span><span class="p">],</span> <span class="n">df_rate</span><span class="p">[</span><span class="s1">&#39;is_win&#39;</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">))</span>
<span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">rfc_train_pred</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">rfc_test_pred</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I will determine the accuracy of the random forest model on both the training and testing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">rfc_train_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9540229885057471
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rfc_test_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9293286219081273
</pre></div>
</div>
</div>
</div>
<p>The accuracy scores of the random forest classifier on the training data and testing data are both over <span class="math notranslate nohighlight">\(0.90\)</span>, which does not suggest that the random forest has overfit the data. Next, I will visualize this with a confusion matrix, the code for which I obtained from: <a class="reference external" href="https://medium.com/analytics-vidhya/evaluating-a-random-forest-model-9d165595ad56">https://medium.com/analytics-vidhya/evaluating-a-random-forest-model-9d165595ad56</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rfc_test_pred</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Losing Team&#39;</span><span class="p">,</span> <span class="s1">&#39;Winning Team&#39;</span><span class="p">]</span>
<span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Label&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Label&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix for Random Forest Classifier&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bb419041bb3ececb7e07e2fb8fd650a618f1d1027264c425e497850f7500d7af.png" src="../../_images/bb419041bb3ececb7e07e2fb8fd650a618f1d1027264c425e497850f7500d7af.png" />
</div>
</div>
<p>A classification report will sum up the confusion matrix with three metrics: precision, recall, and f1 score.
According to <a class="reference external" href="https://medium.com/analytics-vidhya/evaluating-a-random-forest-model-9d165595ad56:">https://medium.com/analytics-vidhya/evaluating-a-random-forest-model-9d165595ad56:</a></p>
<ol class="arabic simple">
<li><p>Precision is the number of correctly-identified members of a class divided by all the times the model predicted that class.</p></li>
<li><p>Recall is the number of members of a class that the classifier identified correctly divided by the total number of members in that class.</p></li>
<li><p>F1 score combines precision and recall into one metric. If precision and recall are both high, F1 will be high, too. If they are both low, F1 will be low. If one is high and the other low, F1 will be low.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rfc_test_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

       False       0.97      0.89      0.93       144
        True       0.89      0.97      0.93       139

    accuracy                           0.93       283
   macro avg       0.93      0.93      0.93       283
weighted avg       0.93      0.93      0.93       283
</pre></div>
</div>
</div>
</div>
<p>Because the precision, recall, and f1 scores for both classes are high (<span class="math notranslate nohighlight">\(\geq0.89\)</span>), we can conclude that the random forest model is accurate at predicting whether a team has a winning record based on their stats. We can now analyze which stats were most important in determining a team’s success.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rfc</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">rfc</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>runs_scored               0.192366
earned_run_average        0.134273
opponents_runs_scored     0.113034
earned_runs_allowed       0.091288
saves                     0.067500
hits                      0.064919
walks_allowed             0.048037
homeruns                  0.044631
hits_allowed              0.035169
walks                     0.033901
shutouts                  0.024170
outs_pitches              0.021774
doubles                   0.014424
at_bats                   0.014272
homeruns_allowed          0.012837
errors                    0.012371
sacrifice_flies           0.012179
strikeouts_by_batters     0.008981
fielding_percentage       0.008807
triples                   0.007699
strikeouts_by_pitchers    0.007344
complete_games            0.006878
caught_stealing           0.006677
stolen_bases              0.006267
batters_hit_by_pitch      0.005247
double_plays              0.004955
dtype: float64
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">runs_scored</span></code>, <code class="docutils literal notranslate"><span class="pre">opponents_runs_scored</span></code>, and <code class="docutils literal notranslate"><span class="pre">earned_run_average</span></code> had the highest feature importances, which means that they were the most significant stats towards a team’s success. This agrees with the previous results found in the linear regression model, which found that <code class="docutils literal notranslate"><span class="pre">earned_run_average</span></code> had the greatest negative effect on winning percentage and <code class="docutils literal notranslate"><span class="pre">runs_scored</span></code> had one of the greatest positive effects on winning percentage.</p>
</section>
<section id="neural-network">
<h2>Neural Network<a class="headerlink" href="#neural-network" title="Permalink to this heading">#</a></h2>
<p>Another criteria to judge a team’s success is how far it goes in the playoffs. Now I will drop the rows with missing values in <code class="docutils literal notranslate"><span class="pre">wild_card_winner</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_playoffs</span> <span class="o">=</span> <span class="n">df_rate</span><span class="p">[</span><span class="o">~</span><span class="n">df_rate</span><span class="p">[</span><span class="s1">&#39;wild_card_winner&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">df_playoffs</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year                      0
games_played              0
wins                      0
losses                    0
division_winner           0
wild_card_winner          0
league_winner             0
world_series_winner       0
runs_scored               0
at_bats                   0
hits                      0
doubles                   0
triples                   0
homeruns                  0
walks                     0
strikeouts_by_batters     0
stolen_bases              0
caught_stealing           0
batters_hit_by_pitch      0
sacrifice_flies           0
opponents_runs_scored     0
earned_runs_allowed       0
earned_run_average        0
complete_games            0
shutouts                  0
saves                     0
outs_pitches              0
hits_allowed              0
homeruns_allowed          0
walks_allowed             0
strikeouts_by_pitchers    0
errors                    0
double_plays              0
fielding_percentage       0
win_percentage            0
is_win                    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>I will create a new column in <code class="docutils literal notranslate"><span class="pre">df_playoffs</span></code> called <code class="docutils literal notranslate"><span class="pre">playoffs</span></code> that correlates to how far each team made in the playoffs. <span class="math notranslate nohighlight">\(0\)</span> correlates to no playoff series wins, <span class="math notranslate nohighlight">\(1\)</span> correlates to winning the wild card, <span class="math notranslate nohighlight">\(2\)</span> correlates to winning the league championship series, and <span class="math notranslate nohighlight">\(3\)</span> correlates to winning the world series. I created <code class="docutils literal notranslate"><span class="pre">playoffs</span></code> using code from: <a class="reference external" href="https://stackoverflow.com/questions/26886653/create-new-column-based-on-values-from-other-columns-apply-a-function-of-multi">https://stackoverflow.com/questions/26886653/create-new-column-based-on-values-from-other-columns-apply-a-function-of-multi</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_playoffs</span><span class="p">[</span><span class="s1">&#39;world_series_winner&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">df_playoffs</span><span class="p">[</span><span class="s1">&#39;league_winner&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">df_playoffs</span><span class="p">[</span><span class="s1">&#39;wild_card_winner&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">]</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">df_playoffs</span><span class="p">[</span><span class="s1">&#39;playoffs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
<span class="n">df_playoffs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_37/169299682.py:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_playoffs[&#39;playoffs&#39;] = np.select(conditions, outputs)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>games_played</th>
      <th>wins</th>
      <th>losses</th>
      <th>division_winner</th>
      <th>wild_card_winner</th>
      <th>league_winner</th>
      <th>world_series_winner</th>
      <th>runs_scored</th>
      <th>at_bats</th>
      <th>...</th>
      <th>hits_allowed</th>
      <th>homeruns_allowed</th>
      <th>walks_allowed</th>
      <th>strikeouts_by_pitchers</th>
      <th>errors</th>
      <th>double_plays</th>
      <th>fielding_percentage</th>
      <th>win_percentage</th>
      <th>is_win</th>
      <th>playoffs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010</th>
      <td>1995</td>
      <td>144</td>
      <td>90</td>
      <td>54</td>
      <td>Y</td>
      <td>N</td>
      <td>Y</td>
      <td>Y</td>
      <td>0.539241</td>
      <td>0.759990</td>
      <td>...</td>
      <td>0.594993</td>
      <td>0.252830</td>
      <td>0.455399</td>
      <td>0.538106</td>
      <td>0.446927</td>
      <td>0.462428</td>
      <td>0.608696</td>
      <td>0.625000</td>
      <td>True</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>1995</td>
      <td>144</td>
      <td>71</td>
      <td>73</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.613924</td>
      <td>0.765699</td>
      <td>...</td>
      <td>0.581001</td>
      <td>0.411321</td>
      <td>0.591549</td>
      <td>0.417244</td>
      <td>0.290503</td>
      <td>0.624277</td>
      <td>0.782609</td>
      <td>0.493056</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012</th>
      <td>1995</td>
      <td>144</td>
      <td>86</td>
      <td>58</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.724051</td>
      <td>0.805411</td>
      <td>...</td>
      <td>0.708395</td>
      <td>0.328302</td>
      <td>0.517997</td>
      <td>0.384911</td>
      <td>0.558659</td>
      <td>0.682081</td>
      <td>0.434783</td>
      <td>0.597222</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>1995</td>
      <td>145</td>
      <td>78</td>
      <td>67</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.736709</td>
      <td>0.810871</td>
      <td>...</td>
      <td>0.687776</td>
      <td>0.464151</td>
      <td>0.533646</td>
      <td>0.394919</td>
      <td>0.418994</td>
      <td>0.502890</td>
      <td>0.608696</td>
      <td>0.537931</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>1995</td>
      <td>145</td>
      <td>68</td>
      <td>76</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.678481</td>
      <td>0.821047</td>
      <td>...</td>
      <td>0.734904</td>
      <td>0.467925</td>
      <td>0.738654</td>
      <td>0.387991</td>
      <td>0.491620</td>
      <td>0.566474</td>
      <td>0.521739</td>
      <td>0.468966</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2779</th>
      <td>2020</td>
      <td>58</td>
      <td>30</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
      <td>0.026582</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.109434</td>
      <td>0.092332</td>
      <td>0.058507</td>
      <td>0.072626</td>
      <td>0.075145</td>
      <td>0.652174</td>
      <td>0.517241</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2780</th>
      <td>2020</td>
      <td>60</td>
      <td>40</td>
      <td>20</td>
      <td>Y</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>0.088608</td>
      <td>0.055349</td>
      <td>...</td>
      <td>0.072901</td>
      <td>0.113208</td>
      <td>0.035994</td>
      <td>0.126251</td>
      <td>0.072626</td>
      <td>0.109827</td>
      <td>0.739130</td>
      <td>0.666667</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2781</th>
      <td>2020</td>
      <td>60</td>
      <td>22</td>
      <td>38</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.006329</td>
      <td>0.045669</td>
      <td>...</td>
      <td>0.075847</td>
      <td>0.154717</td>
      <td>0.142410</td>
      <td>0.077752</td>
      <td>0.111732</td>
      <td>0.040462</td>
      <td>0.565217</td>
      <td>0.366667</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2782</th>
      <td>2020</td>
      <td>60</td>
      <td>32</td>
      <td>28</td>
      <td>N</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
      <td>0.105063</td>
      <td>0.067262</td>
      <td>...</td>
      <td>0.103829</td>
      <td>0.154717</td>
      <td>0.164319</td>
      <td>0.100847</td>
      <td>0.100559</td>
      <td>0.080925</td>
      <td>0.608696</td>
      <td>0.533333</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>2020</td>
      <td>60</td>
      <td>26</td>
      <td>34</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>0.093671</td>
      <td>0.053611</td>
      <td>...</td>
      <td>0.126657</td>
      <td>0.203774</td>
      <td>0.111111</td>
      <td>0.092379</td>
      <td>0.106145</td>
      <td>0.086705</td>
      <td>0.565217</td>
      <td>0.433333</td>
      <td>False</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>774 rows × 37 columns</p>
</div></div></div>
</div>
<p>Because the target variable <code class="docutils literal notranslate"><span class="pre">is_win</span></code> is categorical, the model will use each row’s stats to determine its class in <code class="docutils literal notranslate"><span class="pre">playoffs</span></code>, which is a classification problem. Therefore, I will try to use a neural network to model the relationship between stats and <code class="docutils literal notranslate"><span class="pre">playoffs</span></code>, using the code from <a class="reference external" href="https://www.tensorflow.org/tutorials/keras/classification">https://www.tensorflow.org/tutorials/keras/classification</a>. I also separated the data into training and testing data, which allow us to see if the neural network has overfit our data by testing the model on the testing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df_playoffs</span><span class="p">[</span><span class="n">cols</span><span class="p">],</span> <span class="n">df_playoffs</span><span class="p">[</span><span class="s1">&#39;playoffs&#39;</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/10
20/20 [==============================] - 1s 5ms/step - loss: 0.9253 - accuracy: 0.8336
Epoch 2/10
20/20 [==============================] - 0s 5ms/step - loss: 0.6009 - accuracy: 0.8627
Epoch 3/10
20/20 [==============================] - 0s 5ms/step - loss: 0.5611 - accuracy: 0.8627
Epoch 4/10
20/20 [==============================] - 0s 5ms/step - loss: 0.5538 - accuracy: 0.8627
Epoch 5/10
20/20 [==============================] - 0s 1ms/step - loss: 0.5485 - accuracy: 0.8627
Epoch 6/10
20/20 [==============================] - 0s 2ms/step - loss: 0.5459 - accuracy: 0.8627
Epoch 7/10
20/20 [==============================] - 0s 2ms/step - loss: 0.5434 - accuracy: 0.8627
Epoch 8/10
20/20 [==============================] - 0s 5ms/step - loss: 0.5411 - accuracy: 0.8627
Epoch 9/10
20/20 [==============================] - 0s 4ms/step - loss: 0.5399 - accuracy: 0.8627
Epoch 10/10
20/20 [==============================] - 0s 5ms/step - loss: 0.5374 - accuracy: 0.8627
</pre></div>
</div>
</div>
</div>
<p>The model’s accuracy on the training data is <span class="math notranslate nohighlight">\(0.8627\)</span> (above), while the model’s accuracy on the testing data is <span class="math notranslate nohighlight">\(0.8065\)</span> (below).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span>  <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy:&#39;</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5/5 - 0s - loss: 0.6691 - accuracy: 0.8065 - 86ms/epoch - 17ms/step
Test accuracy: 0.8064516186714172
</pre></div>
</div>
</div>
</div>
<p>Now let’s look at the values predicted by the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">probability_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">model</span><span class="p">,</span> 
                                         <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">probability_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5/5 [==============================] - 0s 2ms/step
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0]), array([155]))
</pre></div>
</div>
</div>
</div>
<p>This indicates that the model has predicted all teams in the testing data to belong to the <span class="math notranslate nohighlight">\(0\)</span> class of <code class="docutils literal notranslate"><span class="pre">playoffs</span></code>. Evidently, the neuron network was not able to distinguish a significant difference in the stats between teams that had playoff success and teams that did not. Therefore, none of the stats are statistically significant in determining a team’s playoff success.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>Using linear regression and a random forest, I determined that a MLB team’s success during the regular season can be predicted by some stats. In particular, runs scored and saves positively correlate to wins, while runs allowed and walks allowed negatively correlate to wins. However, there appears to be no correlation between any of the stats and a team’s playoff success, as shown by a neural network.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<p>Your code above should include references.  Here is some additional space for references.</p>
<ul class="simple">
<li><p>What is the source of your dataset(s)?
<a class="reference external" href="https://www.retrosheet.org">https://www.retrosheet.org</a></p></li>
</ul>
<ul class="simple">
<li><p>List any other references that you found helpful.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Course Project/Student Projects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-the-data">Cleaning the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression-model">Linear Regression Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-classifier">Random Forest Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network">Neural Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yutong Sha
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>